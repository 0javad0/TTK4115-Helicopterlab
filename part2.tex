%%% Local Variables:
%%% mode: latex
%%% TeX-master: "report_main"
%%% End:

\section{Part 2 -- Monovariable control}
\subsection{Problem 1}
We are given the controller shown in \cref{eq:pd_controller}.
\begin{equation}
  \label{eq:pd_controller}
  \tilde{V_d} = K_{pp}(\tilde{p_c} - \tilde{p}) - K_{pd} \dot{\tilde{p}}
\end {equation}
We take this controller and substitute it in the equation for pitch
angle (\cref{eq:pitch}).
\begin{equation}
  \label{eq:pitch_with_pd}
  \ddot{\tilde{p}} = K_1 K_{pp}(\tilde{p_c} - \tilde{p}) - K_1 K_{pd}
  \dot{\tilde{p}}
\end{equation}
Now we Laplace transform \cref{eq:pitch_with_pd} to find the transfer
function $\frac{\tilde{p}(s)}{\tilde{p_c}(s)}$.
\begin{align*}
  \ddot{\tilde{p}} + K_1 K_{pd}\dot{\tilde{p}}
  + K_1K_{pp}\tilde{p} &= K_1 K_{pp}\tilde{p_c} \\
  \mathcal{L}\rightarrow&  \\
  s^2\tilde{p}(s) + sK_1K_{pd}\tilde{p}(s)
  + K_1K_{pp}\tilde{p}(s) &= K_1K_{pp}\tilde{p_c}(s)
\end{align*}
Which gives us our transfer function
\begin{equation}
  \label{eq:trans_func}
  \frac{\tilde{p}(s)}{\tilde{p_c}(s)} = \frac{K_1K_{pp}}{s^2+K_1K_{pd}s+K_1K_{pp}}
\end{equation}

The linearized pitch dynamics can be regarded as a second-order linear
system, which means that if we place \cref{eq:trans_func} on the form
shown in \cref{eq:sol_system} we can determine $K_{pp}$ and $K_{pd}$
from $\omega$ and $\zeta$.
\begin{equation}
  \label{eq:sol_system}
  h(s) = \frac{\omega^2}{s^2+2\zeta\omega^2s+\omega^2}
\end{equation}

This gives us the following relations
\begin{align}
  \label{eq:omega}
  \omega &= \sqrt{K_ 1K_ {pp}} \\
  2\zeta\omega^2 &= K_ 1K_ {pd} \nonumber \\
  \label{eq:zeta}
  \zeta = \frac{K_ 1K_ {pd}}{2\omega^2} &= \frac{K_{pd}}{2K_{pp}}
\end{align}

We know that for a critically damped system $\zeta = 1$, which gives
us

\begin{equation}
  \label{eq:K_pd}
  K_{pd} = 2K_{pp}
\end{equation}

We chose a $K_{pp} = 3$ and then from the relation in \cref{eq:K_pd}
we get $K_{pd} = 6$. With these values the response of the pitch angle
to the input was slower than desired. Therefore, $K_{pp}$ was
increased to $K_{pp} = 12.5$ and $K_{pd}$ was lowered to underdamp the
system, until it  was sufficiently responsive at $K_{pd} = 0.7K_{pp} =
8.75$. At these values the system responded faster with only minor
oscillations. It was observed that larger values of $K_{pp}$ gave rise
to larger oscillations.

\todo[inline]{Figure for that shows poles on Im/Re axis?}

At the critically damped point, the poles lie on the same point on
the x-axis. When $K_{pd}$ is increased in relation to $K_{pp}$ the system is
over-damped the poles move away from each other along the x-axis.
When $K_{pd}$ decreased in relation to $K_{pp}$, the system is under damped
and the poles move away from each other vertically from the critically
damped point.

With the PD controller, it was significantly easier to control the
helicopter than with just feed forward joystick control.


\subsection{Problem 2}
